# Soft Super-Pixel Partitioning for Certified Adversarial Robustness
This repository contains the official code for the paper “Soft Super-Pixel Partitioning for Certified Adversarial Robustness.” We introduce Pixel Partitioning-based Randomized Smoothing (PPRS) and a soft superpixel variant that stabilizes boundary pixels, leading to improved certified robustness.

## Requirements and Setup

## Usage
The easiest way to play with the different super pixel algorithms and their soft counter part is the `test.ipynb` notebook where you can input any image and see how super pixels work!
For certification you can simply run certify.py, for example:


```
python certify.py --dataset cifar10 --base_classifier checkpoint.pth.tar --outfile out.csv --sigma 0.3 --seg True --alg soft --ns 200
```

## Visualization of Soft Superpixels
Here are some visualizations of soft superpixels generated by our method on different images from the ImageNet dataset. 
![](assets/50.png)
![](assets/8620.png)
![](assets/8720.png)
![](assets/30000.png)


One intriguing question is how does soft superpixels look like on different noise levels?
![](assets/summary_noise_30000.png)
![](assets/summary_noise.png)

Below is an ablation of PPRS on different noise levels (0.2, 0.3, 0.4, 0.5) in the ImageNet dataset. As we can see, as the noise level increases, PPRS becomes even more effective.
<p align="center">
  <img src="assets/noise_levels.png" alt="Noise levels" width="400">
</p>
PPRS outperforms other methods and is more robust.

<table>
  <tr>
    <th>ImageNet</th>
    <th>CIFAR-10</th>
  </tr>
  <tr>
    <td align="center">
      <a href="assets/imagenet.png">
        <img src="assets/imagenet.png" alt="ImageNet certified robustness results" width="420">
      </a><br>
    </td>
    <td align="center">
      <a href="assets/cifar.png">
        <img src="assets/cifar.png" alt="CIFAR-10 certified robustness results" width="420">
      </a><br>
    </td>
  </tr>
</table>
